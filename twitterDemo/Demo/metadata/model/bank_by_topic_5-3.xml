<!-- ===================================================================================================== coding to do or check: * TWM_RECORD_CNT - counting the number of records 
after the match fileter
     ===================================================================================================== -->
	 <PMML xmlns="http://www.dmg.org/PMML-4_1" version="4.1">
        <Header copyright="LigaDATA. Copyright 2015" description="TwitterDemo">
                <Application name="TwitterCheckDemo" version="00.01.00"/>
        </Header>
  <!-- ===================================================================================================== -->
        <DataDictionary numberOfFields="19">
                <DataField name="msg" displayName="msg" optype="categorical" dataType="twittermsg"/>
                <DataField name="gCtx" displayName="globalContext" optype="categorical" dataType="EnvContext"/>
                <DataField name="parameters" displayName="parameters" dataType="container">
                        <Value value="gCtx" property="valid"/>
                        <Value value="msg" property="valid"/>
                </DataField>
                 <!-- <<AHMED>> DO WE NEED THIS FIELD ITS NOT BEENG USED IN THE TRANSFORMATION SECTION -->
                <DataField name="cnt_ALL" displayName="cnt_ALL" optype="continuous" dataType="int"/>
				<DataField name="cnt_withalart" displayName="cnt_withalart" optype="continuous" dataType="int"/>
                <!-- simulated 2 dimensional array CNT[ bank, topic ] Full size is CNT[20, 4] -->
                <DataField name="cnt_1_1" displayName="cnt_1_1" optype="continuous" dataType="int"/>
                <DataField name="cnt_1_2" displayName="cnt_1_2" optype="continuous" dataType="int"/>
                <DataField name="cnt_1_3" displayName="cnt_1_3" optype="continuous" dataType="int"/>
                <DataField name="cnt_1_4" displayName="cnt_1_4" optype="continuous" dataType="int"/>
                <DataField name="cnt_2_1" displayName="cnt_2_1" optype="continuous" dataType="int"/>
                <DataField name="cnt_2_2" displayName="cnt_2_2" optype="continuous" dataType="int"/>
                <DataField name="cnt_2_3" displayName="cnt_2_3" optype="continuous" dataType="int"/>
                <DataField name="cnt_2_4" displayName="cnt_2_4" optype="continuous" dataType="int"/>
                <DataField name="cnt_3_1" displayName="cnt_3_1" optype="continuous" dataType="int"/>
                <DataField name="cnt_3_2" displayName="cnt_3_2" optype="continuous" dataType="int"/>
                <DataField name="cnt_3_3" displayName="cnt_3_3" optype="continuous" dataType="int"/>
                <DataField name="cnt_3_4" displayName="cnt_3_4" optype="continuous" dataType="int"/>
                <DataField name="cnt_4_1" displayName="cnt_4_1" optype="continuous" dataType="int"/>
                <DataField name="cnt_4_2" displayName="cnt_4_2" optype="continuous" dataType="int"/>
                <DataField name="cnt_4_3" displayName="cnt_4_3" optype="continuous" dataType="int"/>
                <DataField name="cnt_4_4" displayName="cnt_4_4" optype="continuous" dataType="int"/>
                <DataField name="alertText_1_1" displayName="alertText_1_1" optype="categorical" dataType="string"/>
                <DataField name="alertText_1_2" displayName="alertText_1_2" optype="categorical" dataType="string"/>
                <DataField name="alertText_1_3" displayName="alertText_1_3" optype="categorical" dataType="string"/>
                <DataField name="alertText_1_4" displayName="alertText_1_4" optype="categorical" dataType="string"/>
                <DataField name="alertText_2_1" displayName="alertText_2_1" optype="categorical" dataType="string"/>
                <DataField name="alertText_2_2" displayName="alertText_2_2" optype="categorical" dataType="string"/>
                <DataField name="alertText_2_3" displayName="alertText_2_3" optype="categorical" dataType="string"/>
                <DataField name="alertText_2_4" displayName="alertText_2_4" optype="categorical" dataType="string"/>
                <DataField name="alertText_3_1" displayName="alertText_3_1" optype="categorical" dataType="string"/>
                <DataField name="alertText_3_2" displayName="alertText_3_2" optype="categorical" dataType="string"/>
                <DataField name="alertText_3_3" displayName="alertText_3_3" optype="categorical" dataType="string"/>
                <DataField name="alertText_3_4" displayName="alertText_3_4" optype="categorical" dataType="string"/>
                <DataField name="alertText_4_1" displayName="alertText_4_1" optype="categorical" dataType="string"/>
                <DataField name="alertText_4_2" displayName="alertText_4_2" optype="categorical" dataType="string"/>
                <DataField name="alertText_4_3" displayName="alertText_4_3" optype="categorical" dataType="string"/>
                <DataField name="alertText_4_4" displayName="alertText_4_4" optype="categorical" dataType="string"/>
                <DataField name="result_a" displayName="result_a" optype="categorical" dataType="int"/>
                <DataField name="result_b" displayName="result_b" optype="categorical" dataType="int"/>
                <DataField name="result_c" displayName="result_c" optype="categorical" dataType="int"/>
                <DataField name="result_d" displayName="result_d" optype="categorical" dataType="int"/>
                <DataField name="predictedField" displayName="predictedField" optype="categorical" dataType="integer"/>
                <DataField name="UDFSearchPath" displayName="UDFSearchPath" dataType="container">
                        <Value value="com.ligadata.pmml.udfs.CustomUdfs" property="valid"/>
                </DataField>
                <DataField name="tweet" displayName="tweet" optype="categorical" dataType="string"/>
        </DataDictionary>
        <!-- ===================================================================================================== -->
        <TransformationDictionary>
                <!-- 3) Increment this counter by one, if the current tweet has one or more alerts -->
                <DerivedField name="cumTweetsWithAlerts" dataType="boolean" optype="categorical">
                                                       <!-- <<AHMED>> WHEN THEIS DERIVEDFIELD ARECALLED // changed from integer to boolean -->
                        <Apply function="if"> <!-- here if one of the equal returned false will not check for the others !!! we need to use or
                                <Apply function="and"> -->
                                <Apply function="or">
                                        <Apply function="equal">
                                                <Constant dataType="string"></Constant>
                                                <FieldRef field="alertText_1_1"/>
                                        </Apply>
                                        <Apply function="equal">
                                                <Constant dataType="string"></Constant>
                                                <FieldRef field="alertText_1_2"/>
                                        </Apply>
                                        <Apply function="equal">
                                                <Constant dataType="string"></Constant>
                                                <FieldRef field="alertText_1_3"/>
                                        </Apply>
                                        <Apply function="equal">
                                                <Constant dataType="string"></Constant>
                                                <FieldRef field="alertText_1_4"/>
                                        </Apply>
                        <!-- ...................................... -->
                                        <Apply function="equal">
                                                <Constant dataType="string"></Constant>
                                                <FieldRef field="alertText_2_1"/>
                                        </Apply>
                                        <Apply function="equal">
                                                <Constant dataType="string"></Constant>
                                                <FieldRef field="alertText_2_2"/>
                                        </Apply>
                                        <Apply function="equal">
                                                <Constant dataType="string"></Constant>
                                                <FieldRef field="alertText_2_3"/>
                                        </Apply>
                                        <Apply function="equal">
                                                <Constant dataType="string"></Constant>
                                                <FieldRef field="alertText_2_4"/>
                                        </Apply>
                                <!-- ...................................... -->
                                        <Apply function="equal">
                                                <Constant dataType="string"></Constant>
                                                <FieldRef field="alertText_3_1"/>
                                        </Apply>
                                        <Apply function="equal">
                                                <Constant dataType="string"></Constant>
                                                <FieldRef field="alertText_3_2"/>
                                        </Apply>
                                        <Apply function="equal">
                                                <Constant dataType="string"></Constant>
                                                <FieldRef field="alertText_3_3"/>
                                        </Apply>
                                        <Apply function="equal">
                                                <Constant dataType="string"></Constant>
                                                <FieldRef field="alertText_3_4"/>
                                        </Apply>
                        <!-- ...................................... -->
                                        <Apply function="equal">
                                                <Constant dataType="string"></Constant>
                                                <FieldRef field="alertText_4_1"/>
                                        </Apply>
                                        <Apply function="equal">
                                                <Constant dataType="string"></Constant>
                                                <FieldRef field="alertText_4_2"/>
                                        </Apply>
                                        <Apply function="equal">
                                                <Constant dataType="string"></Constant>
                                                <FieldRef field="alertText_4_3"/>
                                        </Apply>
                                        <Apply function="equal">
                                                <Constant dataType="string"></Constant>
                                                <FieldRef field="alertText_4_4"/>
                                        </Apply>
                        <!-- ...................................... -->
                                </Apply> <!-- end "or" -->
								<!-- Then -->
								<Apply function="and">
									<Apply function="setField">
										<FieldRef field="SumCounters.cumtweetswithalerts"/>
										<FieldRef field="incCumTweetsWithAlerts"/>
									</Apply>
									<Apply function="Put"> <!-- AHMED -->
										<Constant dataType="string">cnt_withalart</Constant>
										<FieldRef field="SumCounters.cumtweetswithalerts"/>
									</Apply>
								</Apply>
								<!-- else -->
								<Constant dataType="boolean">true</Constant>
                        </Apply> <!-- end "if" -->
                </DerivedField>
    
                <!-- ======== LOAD WORDSET _a =================== -->
                <!-- these first word sets are for the "topics" in the GUI, such as lines in the line chart -->
                <!-- 2.2.4) load word set into an array of terms -->
               <DerivedField name="Container_a" dataType="ArrayOfMessageContainerBase" optype="categorical">
				<Apply function="GetArray">
					<FieldRef field="gCtx"/>
					<Constant dataType="string">System.fraud</Constant>
				</Apply>
			</DerivedField>
			<DerivedField name="fraud" dataType="ArrayOfFraud" optype="categorical">
				<Apply function="DownCastArrayMembers">
					<FieldRef field="Container_a"/>
					<Constant dataType="mbrTypename">fraud</Constant>
				</Apply>
			</DerivedField>
               
			<DerivedField name="fraudTermsArray" dataType="ArrayOfString" optype="categorical">
				<Apply function="ToArray">
					<Apply function="ContainerMap">
						<FieldRef field="fraud"/>
						<Constant dataType="ident">terms</Constant>
					</Apply>
				</Apply>
			</DerivedField>
                <!-- ======== LOAD WORDSET _b =================== -->
                <!-- load word set into an array of terms -->
                <DerivedField name="Container_b" dataType="ArrayOfMessageContainerBase" optype="categorical">
                        <Apply function="GetArray">
                                <FieldRef field="gCtx"/>
                                <Constant dataType="string">System.investment</Constant> <!-- specific to data file name -->
                        </Apply>
                </DerivedField>
                <DerivedField name="investment" dataType="ArrayOfInvestment" optype="categorical">
                        <Apply function="DownCastArrayMembers">
                                <FieldRef field="Container_b"/>
                                <Constant dataType="mbrTypename">investment</Constant> <!-- specific to data file name -->
                        </Apply>
                </DerivedField>
                <DerivedField name="investmentTermsArray" dataType="ArrayOfString" optype="categorical">
                        <Apply function="ToArray">
                                <Apply function="ContainerMap">
                                        <FieldRef field="investment"/>
                                        <Constant dataType="ident">terms</Constant>
                                </Apply>
                        </Apply>
                </DerivedField>
                <!-- ======== LOAD WORDSET _c =================== -->
                <!-- load word set into an array of terms -->
                <DerivedField name="Container_c" dataType="ArrayOfMessageContainerBase" optype="categorical">
                        <Apply function="GetArray">
                                <FieldRef field="gCtx"/>
                                <Constant dataType="string">System.retirement</Constant> <!-- specific to data file name -->
                        </Apply>
                </DerivedField>
                <DerivedField name="retirement" dataType="ArrayOfRetirement" optype="categorical">
                        <Apply function="DownCastArrayMembers">
                                <FieldRef field="Container_c"/>
                                <Constant dataType="mbrTypename">retirement</Constant> <!-- specific to data file name -->
                        </Apply>
                </DerivedField>
                <DerivedField name="retirementTermsArray" dataType="ArrayOfString" optype="categorical">
                        <Apply function="ToArray">
                                <Apply function="ContainerMap">
                                        <FieldRef field="retirement"/>
                                        <Constant dataType="ident">terms</Constant>
                                </Apply>
                        </Apply>
                </DerivedField>
    <!-- ======== LOAD WORDSET _d =================== -->
                <!-- load word set into an array of terms -->
                <DerivedField name="Container_d" dataType="ArrayOfMessageContainerBase" optype="categorical">
                        <Apply function="GetArray">
                                <FieldRef field="gCtx"/>
                                <Constant dataType="string">System.security</Constant> <!-- specific to data file name -->
                        </Apply>
                </DerivedField>
                <DerivedField name="security" dataType="ArrayOfSecurity" optype="categorical">
                        <Apply function="DownCastArrayMembers">
                                <FieldRef field="Container_d"/>
                                <Constant dataType="mbrTypename">security</Constant> <!-- specific to data file name -->
                        </Apply>
                </DerivedField>
                <DerivedField name="securityTermsArray" dataType="ArrayOfString" optype="categorical">
                        <Apply function="ToArray">
                                <Apply function="ContainerMap">
                                        <FieldRef field="security"/>
                                        <Constant dataType="ident">terms</Constant>
                                </Apply>
                        </Apply>
                </DerivedField>
    <!-- load the word sets for the top 20 banks and financial publications -->
    <!-- ======== LOAD WORDSET _e =================== -->
                <DerivedField name="Container_e" dataType="ArrayOfMessageContainerBase" optype="categorical">
                        <Apply function="GetArray">
                                <FieldRef field="gCtx"/>
                                <Constant dataType="string">System.financialpubs</Constant> <!-- specific to data file name -->
                        </Apply>
                </DerivedField>
                <DerivedField name="financialpubs" dataType="ArrayOfFinancialpubs" optype="categorical">
                        <Apply function="DownCastArrayMembers">
                                <FieldRef field="Container_e"/>
                                <Constant dataType="mbrTypename">financialpubs</Constant> <!-- specific to data file name -->
                        </Apply>
                </DerivedField>
                <DerivedField name="financialpubsTermsArray" dataType="ArrayOfString" optype="categorical">
                        <Apply function="ToArray">
                                <Apply function="ContainerMap">
                                        <FieldRef field="financialpubs"/>
                                        <Constant dataType="ident">terms</Constant>
                                </Apply>
                        </Apply>
                </DerivedField>
    <!-- ======== LOAD WORDSET _f =================== -->
                <DerivedField name="Container_f" dataType="ArrayOfMessageContainerBase" optype="categorical">
                        <Apply function="GetArray">
                                <FieldRef field="gCtx"/>
                                <Constant dataType="string">System.insurance</Constant> <!-- specific to data file name -->
                        </Apply>
                </DerivedField>
                <DerivedField name="insurance" dataType="ArrayOfInsurance" optype="categorical">
                        <Apply function="DownCastArrayMembers">
                                <FieldRef field="Container_f"/>
                                <Constant dataType="mbrTypename">insurance</Constant> <!-- specific to data file name -->
                        </Apply>
                </DerivedField>
                <DerivedField name="insuranceTermsArray" dataType="ArrayOfString" optype="categorical">
                        <Apply function="ToArray">
                                <Apply function="ContainerMap">
                                        <FieldRef field="insurance"/>
                                        <Constant dataType="ident">terms</Constant>
                                </Apply>
                        </Apply>
                </DerivedField>
    <!-- ======== LOAD WORDSET _g =================== -->
                <DerivedField name="Container_g" dataType="ArrayOfMessageContainerBase" optype="categorical">
                        <Apply function="GetArray">
                                <FieldRef field="gCtx"/>
                                <Constant dataType="string">System.investmentbanks</Constant> <!-- specific to data file name -->
                        </Apply>
                </DerivedField>
                <DerivedField name="investmentbanks" dataType="ArrayOfInvestmentbanks" optype="categorical">
                        <Apply function="DownCastArrayMembers">
                                <FieldRef field="Container_g"/>
                                <Constant dataType="mbrTypename">investmentbanks</Constant> <!-- specific to data file name -->
                        </Apply>
                </DerivedField>
                <DerivedField name="investmentbanksTermsArray" dataType="ArrayOfString" optype="categorical">
                        <Apply function="ToArray">
                                <Apply function="ContainerMap">
                                        <FieldRef field="investmentbanks"/>
                                        <Constant dataType="ident">terms</Constant>
                                </Apply>
                        </Apply>
                </DerivedField>
    <!-- ======== LOAD WORDSET _h =================== -->
                <DerivedField name="Container_h" dataType="ArrayOfMessageContainerBase" optype="categorical">
                        <Apply function="GetArray">
                                <FieldRef field="gCtx"/>
                                <Constant dataType="string">System.retailbanks</Constant> <!-- specific to data file name -->
                        </Apply>
                </DerivedField>
                <DerivedField name="retailbanks" dataType="ArrayOfRetailbanks" optype="categorical">
                        <Apply function="DownCastArrayMembers">
                                <FieldRef field="Container_h"/>
                                <Constant dataType="mbrTypename">retailbanks</Constant> <!-- specific to data file name -->
                        </Apply>
                </DerivedField>
                <DerivedField name="retailbanksTermsArray" dataType="ArrayOfString" optype="categorical">
                        <Apply function="ToArray">
                                <Apply function="ContainerMap">
                                        <FieldRef field="retailbanks"/>
                                        <Constant dataType="ident">terms</Constant>
                                </Apply>
                        </Apply>
                </DerivedField>
                <!-- ======== LOAD WORDSET _i =================== -->
                <!-- ======== LOAD WORDSET _j =================== -->
                <!-- : -->
                <!-- ======== LOAD WORDSET _x =================== -->
                <!-- ======== Increment the various counters ======== -->
                <DerivedField name="IncCounter_1_1" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_1_1"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <DerivedField name="IncCounter_1_2" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_1_2"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <DerivedField name="IncCounter_1_3" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_1_3"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <DerivedField name="IncCounter_1_4" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_1_4"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <!-- ........................................... -->
                <DerivedField name="IncCounter_2_1" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_2_1"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <DerivedField name="IncCounter_2_2" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_2_2"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <DerivedField name="IncCounter_2_3" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_2_3"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <DerivedField name="IncCounter_2_4" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_2_4"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <!-- ........................................... -->
                <DerivedField name="IncCounter_3_1" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_3_1"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <DerivedField name="IncCounter_3_2" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_3_2"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <DerivedField name="IncCounter_3_3" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_3_3"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <DerivedField name="IncCounter_3_4" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_3_4"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <!-- ........................................... -->
                <DerivedField name="IncCounter_4_1" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_4_1"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <DerivedField name="IncCounter_4_2" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_4_2"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <DerivedField name="IncCounter_4_3" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_4_3"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <DerivedField name="IncCounter_4_4" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_4_4"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <!-- ######## check match for a wordset ######## -->
                <!-- Get Summary Counters cosniders all companies under one group -->
                <DerivedField name="SumCounters" dataType="Counters" optype="categorical">
                        <Apply function="GetMsgContainerElseNew">
                                <FieldRef field="gCtx"/>
                                <Constant dataType="typename">SumCounters</Constant>
                                <Constant dataType="string">System.Counters</Constant>
                                <Constant dataType="string">0</Constant>
                        </Apply>
                </DerivedField>
         
                <!-- 2.2.1) check if tweet has wordset _a -->
                <DerivedField name="checkIfMatch_a" dataType="boolean" optype="categorical">
                        <Apply function="getTokenizedBoolean">
                                <FieldRef field="msg.tweet"/>
                                <FieldRef field="fraudTermsArray"/> <!-- 2.2.2 -->
                                <Constant dataType="int">1</Constant>
                        </Apply>
                </DerivedField>
                <!-- Increments the Counter -->
                <DerivedField name="IncCounter_a" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_a"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <!-- ######## check match for a wordset ######## -->
                <DerivedField name="checkIfMatch_b" dataType="boolean" optype="categorical">
                        <Apply function="getTokenizedBoolean">
                                <FieldRef field="msg.tweet"/>
                                <FieldRef field="investmentTermsArray"/> <!-- 2.2.2 -->
                                <Constant dataType="int">1</Constant>
                        </Apply>
                </DerivedField>
                <!-- Increments the Counter -->
                <DerivedField name="IncCounter_b" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_b"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <!-- ######## check match for a wordset ######## -->
          
                <!-- 2.2.1) check if tweet has wordset _c -->
                <DerivedField name="checkIfMatch_c" dataType="boolean" optype="categorical">
                        <Apply function="getTokenizedBoolean">
                                <FieldRef field="msg.tweet"/>
                                <FieldRef field="retirementTermsArray"/> <!-- 2.2.2 -->
                                <Constant dataType="int">1</Constant>
                        </Apply>
                </DerivedField>
                <!-- Increments the Counter -->
                <DerivedField name="IncCounter_c" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_c"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
    <!-- ######## check match for a wordset ######## -->
                <!-- 2.2.1) check if tweet has wordset _d -->
                <DerivedField name="checkIfMatch_d" dataType="boolean" optype="categorical">
                        <Apply function="getTokenizedBoolean">
                                <FieldRef field="msg.tweet"/>
                                <FieldRef field="securityTermsArray"/> <!-- 2.2.2 -->
                                <Constant dataType="int">1</Constant>
                        </Apply>
                </DerivedField>
                <!-- Increments the Counter -->
                <DerivedField name="IncCounter_d" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_d"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <!-- ######## check match for a wordset ######## -->
                <!-- 2.2.1) check if tweet has wordset _e -->
                <DerivedField name="checkIfMatch_e" dataType="boolean" optype="categorical">
                        <Apply function="getTokenizedBoolean">
                                <FieldRef field="msg.tweet"/>
                                <FieldRef field="financialpubsTermsArray"/> <!-- 2.2.2 -->
                                <Constant dataType="int">1</Constant>
                        </Apply>
                </DerivedField>
                <!-- Increments the Counter -->
                <DerivedField name="IncCounter_e" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_e"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <!-- 2.2.1) check if tweet has wordset _f -->
                <DerivedField name="checkIfMatch_f" dataType="boolean" optype="categorical">
                        <Apply function="getTokenizedBoolean">
                                <FieldRef field="msg.tweet"/>
                                <FieldRef field="insuranceTermsArray"/> <!-- 2.2.2 -->
                                <Constant dataType="int">1</Constant>
                        </Apply>
                </DerivedField>
                <!-- Increments the Counter -->
                <DerivedField name="IncCounter_f" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_f"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <!-- ######## check match for a wordset ######## -->
                <!-- 2.2.1) check if tweet has wordset _g -->
                <DerivedField name="checkIfMatch_g" dataType="boolean" optype="categorical">
                        <Apply function="getTokenizedBoolean">
                                <FieldRef field="msg.tweet"/>
                                <FieldRef field="investmentbanksTermsArray"/> <!-- 2.2.2 -->
                                <Constant dataType="int">1</Constant>
                        </Apply>
                </DerivedField>
                <!-- Increments the Counter -->
                <DerivedField name="IncCounter_g" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_g"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <!-- 2.2.1) check if tweet has wordset _h -->
                <DerivedField name="checkIfMatch_h" dataType="boolean" optype="categorical">
                        <Apply function="getTokenizedBoolean">
                                <FieldRef field="msg.tweet"/>
                                <FieldRef field="retailbanksTermsArray"/> <!-- 2.2.2 -->
                                <Constant dataType="int">1</Constant>
                        </Apply>
                </DerivedField>
                <!-- Increments the Counter -->
                <DerivedField name="IncCounter_h" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.cnt_h"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
				
				 <DerivedField name="incCumTweetsWithAlerts" dataType="integer" optype="categorical">
						<Apply function="+">
                            <FieldRef field="SumCounters.cumtweetswithalerts"/>
                            <Constant dataType="integer">1</Constant>
                        </Apply>
				</DerivedField>
				
				
                <DerivedField name="incMatchCounter" dataType="integer" optype="categorical">
                        <Apply function="+">
                                <FieldRef field="SumCounters.matchcounter"/>
                                <Constant dataType="integer">1</Constant>
                        </Apply>
                </DerivedField>
                <!-- 2.3.1) -->
                <!-- ALL 16 HARD CODED IF STATMENTS AND COUNTER INCREMENTS HERE -->
                <DerivedField name="incrSetSumCounters" dataType="boolean" optype="categorical">
                        <Apply function="and">
                                <Apply function="setField">
                                        <FieldRef field="SumCounters.key"/>
                                        <Constant dataType="string">0</Constant>
                                </Apply>
                                <Apply function="setField">
                                        <FieldRef field="SumCounters.matchcounter"/> <!-- Ahmed-->
                                        <FieldRef field="incMatchCounter"/>
                                </Apply>
                        <!-- ===================================================== -->
                                <Apply function="if">
                                <!-- (CONDITION) -->
                                        <Apply function="and">
                                                <FieldRef field="checkIfMatch_a"/>
                                                <FieldRef field="checkIfMatch_e"/>
                                        </Apply> <!-- end checking if there is a match for [a,e] -->
                                        <!-- THEN -->
                                        <Apply function="setField">
                                                <FieldRef field="SumCounters.cnt_1_1"/>
                                                <FieldRef field="IncCounter_1_1"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" (..) -->
                                <Apply function="if">
                                <!-- (CONDITION) -->
                                        <Apply function="and">
                                                <FieldRef field="checkIfMatch_a"/>
                                                <FieldRef field="checkIfMatch_f"/>
                                        </Apply> <!-- end checking if there is a match for [,] -->
                                        <!-- THEN -->
                                        <Apply function="setField">
                                                <FieldRef field="SumCounters.cnt_1_2"/>
                                                <FieldRef field="IncCounter_1_2"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" (..) -->
                                <Apply function="if">
                                <!-- (CONDITION) -->
                                        <Apply function="and">
                                                <FieldRef field="checkIfMatch_a"/>
                                                <FieldRef field="checkIfMatch_g"/>
                                        </Apply> <!-- end checking if there is a match for [,] -->
                                <!-- THEN -->
                                        <Apply function="setField">
                                                <FieldRef field="SumCounters.cnt_1_3"/>
                                        <FieldRef field="IncCounter_1_3"/>
                                        </Apply>
                                <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" (..) -->
                                <Apply function="if">
                                <!-- (CONDITION) -->
                                        <Apply function="and">
                                                <FieldRef field="checkIfMatch_a"/>
                                                <FieldRef field="checkIfMatch_h"/>
                                        </Apply> <!-- end checking if there is a match for [,] -->
                                <!-- THEN -->
                                        <Apply function="setField">
                                                <FieldRef field="SumCounters.cnt_1_4"/>
                                                <FieldRef field="IncCounter_1_4"/>
                                        </Apply>
                                <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" (..) -->
                        <!-- ..................................................... -->
                                <Apply function="if">
                                <!-- (CONDITION) -->
                                        <Apply function="and">
                                                <FieldRef field="checkIfMatch_b"/>
                                                <FieldRef field="checkIfMatch_e"/>
                                        </Apply> <!-- end checking if there is a match for [,] -->
                                        <!-- THEN -->
                                        <Apply function="setField">
                                                <FieldRef field="SumCounters.cnt_2_1"/>
                                                <FieldRef field="IncCounter_2_1"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" (..) -->
                                <Apply function="if">
                                <!-- (CONDITION) -->
                                        <Apply function="and">
                                                <FieldRef field="checkIfMatch_b"/>
                                                <FieldRef field="checkIfMatch_f"/>
                                        </Apply> <!-- end checking if there is a match for [,] -->
                                        <!-- THEN -->
                                        <Apply function="setField">
                                                <FieldRef field="SumCounters.cnt_2_2"/>
                                                <FieldRef field="IncCounter_2_2"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" (..) -->
                                <Apply function="if">
                                <!-- (CONDITION) -->
                                        <Apply function="and">
                                                <FieldRef field="checkIfMatch_b"/>
                                                <FieldRef field="checkIfMatch_g"/>
                                        </Apply> <!-- end checking if there is a match for [,] -->
                                        <!-- THEN -->
                                        <Apply function="setField">
                                                <FieldRef field="SumCounters.cnt_2_3"/>
                                                <FieldRef field="IncCounter_2_3"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" (..) -->
                                <Apply function="if">
                                <!-- (CONDITION) -->
                                        <Apply function="and">
                                                <FieldRef field="checkIfMatch_b"/>
                                                <FieldRef field="checkIfMatch_h"/>
                                        </Apply> <!-- end checking if there is a match for [,] -->
                                        <!-- THEN -->
                                        <Apply function="setField">
                                                <FieldRef field="SumCounters.cnt_2_4"/>
                                                <FieldRef field="IncCounter_2_4"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" (..) -->
                                <!-- ..................................................... -->
                                <Apply function="if">
                                <!-- (CONDITION) -->
                                        <Apply function="and">
                                                <FieldRef field="checkIfMatch_c"/>
                                                <FieldRef field="checkIfMatch_e"/>
                                        </Apply> <!-- end checking if there is a match for [,] -->
                                        <!-- THEN -->
                                        <Apply function="setField">
                                                <FieldRef field="SumCounters.cnt_3_1"/>
                                                <FieldRef field="IncCounter_3_1"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" (..) -->
                                <Apply function="if">
                                <!-- (CONDITION) -->
                                        <Apply function="and">
                                                <FieldRef field="checkIfMatch_c"/>
                                                <FieldRef field="checkIfMatch_f"/>
                                        </Apply> <!-- end checking if there is a match for [,] -->
                                        <!-- THEN -->
                                        <Apply function="setField">
                                                <FieldRef field="SumCounters.cnt_3_2"/>
                                                <FieldRef field="IncCounter_3_2"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" (..) -->
                                <Apply function="if">
                                <!-- (CONDITION) -->
                                        <Apply function="and">
                                                <FieldRef field="checkIfMatch_c"/>
                                                <FieldRef field="checkIfMatch_g"/>
                                        </Apply> <!-- end checking if there is a match for [,] -->
                                        <!-- THEN -->
                                        <Apply function="setField">
                                                <FieldRef field="SumCounters.cnt_3_3"/>
                                                <FieldRef field="IncCounter_3_3"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" (..) -->
                                <Apply function="if">
                                <!-- (CONDITION) -->
                                        <Apply function="and">
                                                <FieldRef field="checkIfMatch_c"/>
                                                <FieldRef field="checkIfMatch_h"/>
                                        </Apply> <!-- end checking if there is a match for [,] -->
                                        <!-- THEN -->
                                        <Apply function="setField">
                                                <FieldRef field="SumCounters.cnt_3_4"/>
                                                <FieldRef field="IncCounter_3_4"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" (..) -->
                                <!-- ..................................................... -->
                                <Apply function="if">
                                <!-- (CONDITION) -->
                                        <Apply function="and">
                                                <FieldRef field="checkIfMatch_d"/>
                                                <FieldRef field="checkIfMatch_e"/>
                                        </Apply> <!-- end checking if there is a match for [a,d] -->
                                        <!-- THEN -->
                                        <Apply function="setField">
                                                <FieldRef field="SumCounters.cnt_4_1"/>
                                                <FieldRef field="IncCounter_4_1"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" (..) -->
                                <Apply function="if">
                                <!-- (CONDITION) -->
                                        <Apply function="and">
                                                <FieldRef field="checkIfMatch_d"/>
                                                <FieldRef field="checkIfMatch_f"/>
                                        </Apply> <!-- end checking if there is a match for [,] -->
                                        <!-- THEN -->
                                        <Apply function="setField">
                                                <FieldRef field="SumCounters.cnt_4_2"/>
                                                <FieldRef field="IncCounter_4_2"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" (..) -->
                                <Apply function="if">
                                <!-- (CONDITION) -->
                                        <Apply function="and">
                                                <FieldRef field="checkIfMatch_d"/>
                                                <FieldRef field="checkIfMatch_g"/>
                                        </Apply> <!-- end checking if there is a match for [,] -->
                                        <!-- THEN -->
                                        <Apply function="setField">
                                                <FieldRef field="SumCounters.cnt_4_3"/>
                                                <FieldRef field="IncCounter_4_3"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" (..) -->
                                <Apply function="if">
                                <!-- (CONDITION) -->
                                        <Apply function="and">
                                                <FieldRef field="checkIfMatch_d"/>
                                                <FieldRef field="checkIfMatch_h"/>
                                        </Apply> <!-- end checking if there is a match for [,] -->
                                        <!-- THEN -->
                                        <Apply function="setField">
                                                <FieldRef field="SumCounters.cnt_4_4"/>
                                                <FieldRef field="IncCounter_4_4"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" (..) -->
                                <!-- ..................................................... -->
                        </Apply> <!-- end COMPOUND STATEMENT with "and" -->
                </DerivedField> <!-- end incrSetSumCounters -->
                <!-- 2.3.2) Save the Incremented conters to db -->
                <DerivedField name="SaveincrSetSumCounters" dataType="boolean" optype="categorical">
                        <Apply function="Put">
                                <FieldRef field="gCtx"/>
                                <Constant dataType="string">System.Counters</Constant>
                                <FieldRef field="SumCounters.key"/>
                                <FieldRef field="SumCounters"/>
                        </Apply>
                </DerivedField>
                <!-- 2.3.3) Sets value to the return variable -->
                <!-- SET ALL 16 RETURN VALUES FOR THE OUTPUT JSON RECORD HERE -->
                <DerivedField name="setAndPrepareReturnString" dataType="boolean" optype="categorical">
                        <Apply function="and">
                        <!-- ......................................... -->
                                <Apply function="Put">
                                        <Constant dataType="string">cnt_1_1</Constant>
                                        <FieldRef field="SumCounters.cnt_1_1"/>
                                </Apply>
                                <Apply function="Put">
                                        <Constant dataType="string">cnt_1_2</Constant>
                                        <FieldRef field="SumCounters.cnt_1_2"/>
                                </Apply>
                                <Apply function="Put">
                                        <Constant dataType="string">cnt_1_3</Constant>
                                        <FieldRef field="SumCounters.cnt_1_3"/>
                                </Apply>
                                <Apply function="Put">
                                        <Constant dataType="string">cnt_1_4</Constant>
                                <FieldRef field="SumCounters.cnt_1_4"/>
                                </Apply>
                        <!-- ......................................... -->
                                <Apply function="Put">
                                        <Constant dataType="string">cnt_2_1</Constant>
                                        <FieldRef field="SumCounters.cnt_2_1"/>
                                </Apply>
                                <Apply function="Put">
                                        <Constant dataType="string">cnt_2_2</Constant>
                                        <FieldRef field="SumCounters.cnt_2_2"/>
                                </Apply>
                                <Apply function="Put">
                                        <Constant dataType="string">cnt_2_3</Constant>
                                        <FieldRef field="SumCounters.cnt_2_3"/>
                                </Apply>
                                <Apply function="Put">
                                        <Constant dataType="string">cnt_2_4</Constant>
                                        <FieldRef field="SumCounters.cnt_2_4"/>
                                </Apply>
                        <!-- ......................................... -->
                                <Apply function="Put">
                                        <Constant dataType="string">cnt_3_1</Constant>
                                        <FieldRef field="SumCounters.cnt_3_1"/>
                                </Apply>
                                <Apply function="Put">
                                        <Constant dataType="string">cnt_3_2</Constant>
                                        <FieldRef field="SumCounters.cnt_3_2"/>
                                </Apply>
                                <Apply function="Put">
                                        <Constant dataType="string">cnt_3_3</Constant>
                                        <FieldRef field="SumCounters.cnt_3_3"/>
                                </Apply>
                                <Apply function="Put">
                                        <Constant dataType="string">cnt_3_4</Constant>
                                        <FieldRef field="SumCounters.cnt_3_4"/>
                                </Apply>
                        <!-- ......................................... -->
                                <Apply function="Put">
                                        <Constant dataType="string">cnt_4_1</Constant>
                                        <FieldRef field="SumCounters.cnt_4_1"/>
                                </Apply>
                                <Apply function="Put">
                                        <Constant dataType="string">cnt_4_2</Constant>
                                        <FieldRef field="SumCounters.cnt_4_2"/>
                                </Apply>
                                <Apply function="Put">
                                        <Constant dataType="string">cnt_4_3</Constant>
                                        <FieldRef field="SumCounters.cnt_4_3"/>
                                </Apply>
                                <Apply function="Put">
                                        <Constant dataType="string">cnt_4_4</Constant>
                                        <FieldRef field="SumCounters.cnt_4_4"/>
                                </Apply>
								<Apply function="Put"> <!-- AHMED -->
									<Constant dataType="string">cnt_ALL</Constant>
									<FieldRef field="SumCounters.matchcounter"/>
								</Apply>
                        </Apply>
                </DerivedField> <!-- end setAndPrepareReturnString -->
                <!-- ===================================================================== -->
                <!-- 2.3.4.1) -->
                <DerivedField name="PrepareAlertMsg_1_1" dataType="string" optype="categorical">
                        <Apply function="Concat">
                                <FieldRef field="cnt_1_1"/>
                                <Constant dataType="string">..fraud and financial publication alerts at min..</Constant>
                                <FieldRef field="msg.tweet_date_time"/>
                        </Apply>
                </DerivedField>
                <DerivedField name="PrepareAlertMsg_1_2" dataType="string" optype="categorical">
                        <Apply function="Concat">
                                <FieldRef field="cnt_1_2"/>
                                <Constant dataType="string">..fraud and insurance alerts at min..</Constant>
                                <FieldRef field="msg.tweet_date_time"/>
                        </Apply>
                </DerivedField>
                <DerivedField name="PrepareAlertMsg_1_3" dataType="string" optype="categorical">
                        <Apply function="Concat">
                                <FieldRef field="cnt_1_3"/>
                                <Constant dataType="string">..fraud and investment banks alerts at min..</Constant>
                                <FieldRef field="msg.tweet_date_time"/>
                        </Apply>
                </DerivedField>
                <DerivedField name="PrepareAlertMsg_1_4" dataType="string" optype="categorical">
                        <Apply function="Concat">
                                <FieldRef field="cnt_1_4"/>
                                <Constant dataType="string">..fraud and retail banks alerts at min..</Constant>
                                <FieldRef field="msg.tweet_date_time"/>
                        </Apply>
                </DerivedField>
                <!-- ................................................................ -->
                <DerivedField name="PrepareAlertMsg_2_1" dataType="string" optype="categorical">
                        <Apply function="Concat">
                                <FieldRef field="cnt_2_1"/>
                                <Constant dataType="string">..investment and financial publication alerts at min..</Constant>
                                <FieldRef field="msg.tweet_date_time"/>
                        </Apply>
                </DerivedField>
                <DerivedField name="PrepareAlertMsg_2_2" dataType="string" optype="categorical">
                        <Apply function="Concat">
                                <FieldRef field="cnt_2_2"/>
                                <Constant dataType="string">..investment and insurance alerts at min..</Constant>
                                <FieldRef field="msg.tweet_date_time"/>
                        </Apply>
                </DerivedField>
                <DerivedField name="PrepareAlertMsg_2_3" dataType="string" optype="categorical">
                        <Apply function="Concat">
                                <FieldRef field="cnt_2_3"/>
                                <Constant dataType="string">..investment and investment banks alerts at min..</Constant>
                                <FieldRef field="msg.tweet_date_time"/>
                        </Apply>
                </DerivedField>
                <DerivedField name="PrepareAlertMsg_2_4" dataType="string" optype="categorical">
                        <Apply function="Concat">
                                <FieldRef field="cnt_2_4"/>
                                <Constant dataType="string">..investment and retail banks alerts at min..</Constant>
                                <FieldRef field="msg.tweet_date_time"/>
                        </Apply>
                </DerivedField>
                <!-- ................................................................ -->
                <DerivedField name="PrepareAlertMsg_3_1" dataType="string" optype="categorical">
                        <Apply function="Concat">
                                <FieldRef field="cnt_3_1"/>
                                <Constant dataType="string">..security and financial publication alerts at min..</Constant>
                                <FieldRef field="msg.tweet_date_time"/>
                        </Apply>
                </DerivedField>
                <DerivedField name="PrepareAlertMsg_3_2" dataType="string" optype="categorical">
                        <Apply function="Concat">
                                <FieldRef field="cnt_3_2"/>
                                <Constant dataType="string">..security and insurance alerts at min..</Constant>
                                <FieldRef field="msg.tweet_date_time"/>
                        </Apply>
                </DerivedField>
                <DerivedField name="PrepareAlertMsg_3_3" dataType="string" optype="categorical">
                        <Apply function="Concat">
                                <FieldRef field="cnt_3_3"/>
                                <Constant dataType="string">..security and investment banks alerts at min..</Constant>
                                <FieldRef field="msg.tweet_date_time"/>
                        </Apply>
                </DerivedField>
                <DerivedField name="PrepareAlertMsg_3_4" dataType="string" optype="categorical">
                        <Apply function="Concat">
                                <FieldRef field="cnt_3_4"/>
                                <Constant dataType="string">..security and retail banks alerts at min..</Constant>
                                <FieldRef field="msg.tweet_date_time"/>
                        </Apply>
                </DerivedField>
                <!-- ................................................................ -->
                <DerivedField name="PrepareAlertMsg_4_1" dataType="string" optype="categorical">
                        <Apply function="Concat">
                                <FieldRef field="cnt_4_1"/>
                                <Constant dataType="string">..retirement and financial publication alerts at min..</Constant>
                                <FieldRef field="msg.tweet_date_time"/>
                        </Apply>
                </DerivedField>
                <DerivedField name="PrepareAlertMsg_4_2" dataType="string" optype="categorical">
                        <Apply function="Concat">
                                <FieldRef field="cnt_4_2"/>
                                <Constant dataType="string">..retirement and insurance alerts at min..</Constant>
                                <FieldRef field="msg.tweet_date_time"/>
                        </Apply>
                </DerivedField>
                <DerivedField name="PrepareAlertMsg_4_3" dataType="string" optype="categorical">
                        <Apply function="Concat">
                                <FieldRef field="cnt_4_3"/>
                                <Constant dataType="string">..retirement and investment banks alerts at min..</Constant>
                                <FieldRef field="msg.tweet_date_time"/>
                        </Apply>
                </DerivedField>
                <DerivedField name="PrepareAlertMsg_4_4" dataType="string" optype="categorical">
                        <Apply function="Concat">
                                <FieldRef field="cnt_4_4"/>
                                <Constant dataType="string">..retirement and retail banks alerts at min..</Constant>
                                <FieldRef field="msg.tweet_date_time"/>
                        </Apply>
                </DerivedField>
                <!-- ================================================================ -->
                <!-- 2.3.4) -->
                <!-- Check if threshold is passed for each Object and prepare returning string for GUI -->
                <DerivedField name="checkThreshold" dataType="boolean" optype="categorical">
                        <Apply function="and"> <!-- implementing a COMPOUND STATEMENT here -->
                                <Apply function="if">
                                        <Apply function="GreaterOrEqual">
                                                <FieldRef field="cnt_1_1"/>
                                                <Constant dataType="integer">0</Constant>
                                        </Apply>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">alertText_1_1</Constant>
                                                <FieldRef field="PrepareAlertMsg_1_1"/> <!-- 2.3.4.1 -->
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" -->
                                <Apply function="if">
                                        <Apply function="GreaterOrEqual">
                                                <FieldRef field="cnt_1_2"/>
                                                <Constant dataType="integer">0</Constant>
                                        </Apply>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">alertText_1_2</Constant>
                                                <FieldRef field="PrepareAlertMsg_1_2"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" -->
                                <Apply function="if">
                                        <Apply function="GreaterOrEqual">
                                                <FieldRef field="cnt_1_3"/>
                                                <Constant dataType="integer">0</Constant>
                                        </Apply>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">alertText_1_3</Constant>
                                                <FieldRef field="PrepareAlertMsg_1_3"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" -->
                                <Apply function="if">
                                        <Apply function="GreaterOrEqual">
                                                <FieldRef field="cnt_1_4"/>
                                                <Constant dataType="integer">0</Constant>
                                        </Apply>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">alertText_1_4</Constant>
                                                <FieldRef field="PrepareAlertMsg_1_4"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" -->
                                <!-- ................................................... -->
                                <Apply function="if">
                                        <Apply function="GreaterOrEqual">
                                                <FieldRef field="cnt_2_1"/>
                                                <Constant dataType="integer">0</Constant>
                                        </Apply>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">alertText_2_1</Constant>
                                                <FieldRef field="PrepareAlertMsg_2_1"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" -->
                                <Apply function="if">
                                        <Apply function="GreaterOrEqual">
                                                <FieldRef field="cnt_2_2"/>
                                                <Constant dataType="integer">0</Constant>
                                        </Apply>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">alertText_2_2</Constant>
                                                <FieldRef field="PrepareAlertMsg_2_2"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" -->
                                <Apply function="if">
                                        <Apply function="GreaterOrEqual">
                                                <FieldRef field="cnt_2_3"/>
                                                <Constant dataType="integer">0</Constant>
                                        </Apply>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">alertText_2_3</Constant>
                                                <FieldRef field="PrepareAlertMsg_2_3"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" -->
                                <Apply function="if">
                                        <Apply function="GreaterOrEqual">
                                                <FieldRef field="cnt_2_4"/>
                                                <Constant dataType="integer">0</Constant>
                                        </Apply>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">alertText_2_4</Constant>
                                                <FieldRef field="PrepareAlertMsg_2_4"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" -->
                                <!-- ................................................... -->
                                <Apply function="if">
                                        <Apply function="GreaterOrEqual">
                                                <FieldRef field="cnt_3_1"/>
                                                <Constant dataType="integer">0</Constant>
                                        </Apply>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">alertText_3_1</Constant>
                                                <FieldRef field="PrepareAlertMsg_3_1"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" -->
                                <Apply function="if">
                                        <Apply function="GreaterOrEqual">
                                                <FieldRef field="cnt_3_2"/>
                                                <Constant dataType="integer">0</Constant>
                                        </Apply>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">alertText_3_2</Constant>
                                                <FieldRef field="PrepareAlertMsg_3_2"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" -->
                                <Apply function="if">
                                        <Apply function="GreaterOrEqual">
                                                <FieldRef field="cnt_3_3"/>
                                                <Constant dataType="integer">0</Constant>
                                        </Apply>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">alertText_3_3</Constant>
                                                <FieldRef field="PrepareAlertMsg_3_3"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" -->
                                <Apply function="if">
                                        <Apply function="GreaterOrEqual">
                                                <FieldRef field="cnt_3_4"/>
                                                <Constant dataType="integer">0</Constant>
                                        </Apply>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">alertText_3_4</Constant>
                                                <FieldRef field="PrepareAlertMsg_3_4"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" -->
                        <!-- ................................................... -->
                                <Apply function="if">
                                        <Apply function="GreaterOrEqual">
                                                <FieldRef field="cnt_4_1"/>
                                                <Constant dataType="integer">0</Constant>
                                        </Apply>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">alertText_4_1</Constant>
                                                <FieldRef field="PrepareAlertMsg_4_1"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" -->
                                <Apply function="if">
                                        <Apply function="GreaterOrEqual">
                                                <FieldRef field="cnt_4_2"/>
                                                <Constant dataType="integer">0</Constant>
                                        </Apply>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">alertText_4_2</Constant>
                                                <FieldRef field="PrepareAlertMsg_4_2"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" -->
                                <Apply function="if">
                                        <Apply function="GreaterOrEqual">
                                                <FieldRef field="cnt_4_3"/>
                                                <Constant dataType="integer">0</Constant>
                                        </Apply>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">alertText_4_3</Constant>
                                                <FieldRef field="PrepareAlertMsg_4_3"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" -->
                                <Apply function="if">
                                        <Apply function="GreaterOrEqual">
                                                <FieldRef field="cnt_4_4"/>
                                                <Constant dataType="integer">0</Constant>
                                        </Apply>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">alertText_4_4</Constant>
                                                <FieldRef field="PrepareAlertMsg_4_4"/>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">true</Constant>
                                </Apply> <!-- end "if" -->
                                <!-- ................................................... -->
                        </Apply> <!-- end the compound statment, impelmented with "and" -->
                </DerivedField> <!-- end checkThreshold -->
                <!-- 2.3) Steps to take when the 'if' return a "true" -->
                <DerivedField name="successPath" dataType="boolean" optype="categorical">
                        <Apply function="and"> <!-- simulated COMPOUND STATEMENT -->
                                <FieldRef field="incrSetSumCounters"/> <!-- 2.3.1 -->
                                                               <!-- 2.3.2 -->
                                <FieldRef field="setAndPrepareReturnString"/> <!-- 2.3.3 -->
                                <FieldRef field="checkThreshold"/> <!-- 2.3.4 -->
                                <FieldRef field="cumTweetsWithAlerts"/>
                                <FieldRef field="SaveincrSetSumCounters"/>
                        </Apply>
                </DerivedField> <!-- end successPath -->
                <!-- Kunal or Ahmed, please correct this.  TermsArray_e, _f, _g, _h.  -->
                <!-- sum() to implement COMPOUND STATEMENT and always execute.  other funcs return 0/1 integer -->
                <DerivedField name="checkIfMatchAny" dataType="boolean" optype="categorical">
                        <Apply function="and">
                                <Apply function="if">
                                        <FieldRef field="checkIfMatch_a"/>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">result_a</Constant>
                                                <Constant dataType="int">1</Constant>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Apply function="Put">
                                                <Constant dataType="string">result_a</Constant>
                                                <Constant dataType="int">0</Constant>
                                        </Apply>
                                </Apply>
                                <Apply function="if">
                                        <FieldRef field="checkIfMatch_b"/>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">result_b</Constant>
                                                <Constant dataType="int">1</Constant>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Apply function="Put">
                                                <Constant dataType="string">result_b</Constant>
                                                <Constant dataType="int">0</Constant>
                                        </Apply>
                                </Apply>
                                <Apply function="if">
                                        <FieldRef field="checkIfMatch_c"/>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">result_c</Constant>
                                                <Constant dataType="int">1</Constant>
                                        </Apply>
                                        <!-- ELSE -->
                                        <Apply function="Put">
                                                <Constant dataType="string">result_c</Constant>
                                                <Constant dataType="int">0</Constant>
                                        </Apply>
                                </Apply>
                                <Apply function="if">
                                        <FieldRef field="checkIfMatch_d"/>
                                        <!-- THEN -->
                                        <Apply function="Put">
                                                <Constant dataType="string">result_d</Constant>
                                                <Constant dataType="int">1</Constant>
                                        </Apply>
                                        <!-- ELSE -->
                                            <Apply function="Put">
                                                <Constant dataType="string">result_d</Constant>
                                                <Constant dataType="int">0</Constant>
                                        </Apply>
                                </Apply>
                        </Apply>
                </DerivedField> <!-- end checkIfMatch -->
				
				<DerivedField name="doSum" dataType="integer" optype="categorical">
					<Apply function="+">
						<FieldRef field="result_a"/>
						<FieldRef field="result_b"/>
						<FieldRef field="result_c"/>
						<FieldRef field="result_d"/>
					</Apply>
				</DerivedField>
				
                <!-- 2.1) -->
                <!-- 2) Called by ScoreCheckRule - for this variable to be created -->
                <DerivedField name="scoreCheckTweets" dataType="boolean" optype="categorical">
                        <Apply function="and">
                                <FieldRef field="checkIfMatchAny"/>
                                <Apply function="if"> <!-- 2.2 -->
                                        <Apply function="GreaterThan">
                                                <FieldRef field="doSum"/>
                                                <Constant dataType="integer">0</Constant>
                                        </Apply>
                                        <!-- THEN -->
                                        <FieldRef field="successPath"/> <!-- 2.3 -->
                                        <!-- ELSE -->
                                        <Constant dataType="boolean">false</Constant>
                                </Apply>
                        </Apply>
                </DerivedField> <!-- end scoreCheckTweets -->
        </TransformationDictionary>
        <!-- ===================================================================================================== -->
        <RuleSetModel modelName="DemoModel" functionName="classification" algorithmName="RuleSet">
                <!-- For Fatafat (only), list the variables in the output record -->
                <!-- for normal PMML, these are the fields avilable to be used by the model -->
                <MiningSchema>
                        <MiningField name="cnt_1_1" usageType="supplementary"/>
                        <MiningField name="cnt_1_2" usageType="supplementary"/>
                        <MiningField name="cnt_1_3" usageType="supplementary"/>
                        <MiningField name="cnt_1_4" usageType="supplementary"/>
                        <MiningField name="cnt_2_1" usageType="supplementary"/>
                        <MiningField name="cnt_2_2" usageType="supplementary"/>
                        <MiningField name="cnt_2_3" usageType="supplementary"/>
                        <MiningField name="cnt_2_4" usageType="supplementary"/>
                        <MiningField name="cnt_3_1" usageType="supplementary"/>
                        <MiningField name="cnt_3_2" usageType="supplementary"/>
                        <MiningField name="cnt_3_3" usageType="supplementary"/>
                        <MiningField name="cnt_3_4" usageType="supplementary"/>
                        <MiningField name="cnt_4_1" usageType="supplementary"/>
                        <MiningField name="cnt_4_2" usageType="supplementary"/>
                        <MiningField name="cnt_4_3" usageType="supplementary"/>
                        <MiningField name="cnt_4_4" usageType="supplementary"/>
                        <MiningField name="alertText_1_1" usageType="supplementary"/>
                        <MiningField name="alertText_1_2" usageType="supplementary"/>
                        <MiningField name="alertText_1_3" usageType="supplementary"/>
                        <MiningField name="alertText_1_4" usageType="supplementary"/>
                        <MiningField name="alertText_2_1" usageType="supplementary"/>
                        <MiningField name="alertText_2_2" usageType="supplementary"/>
                        <MiningField name="alertText_2_3" usageType="supplementary"/>
                        <MiningField name="alertText_2_4" usageType="supplementary"/>
                        <MiningField name="alertText_3_1" usageType="supplementary"/>
                        <MiningField name="alertText_3_2" usageType="supplementary"/>
                        <MiningField name="alertText_3_3" usageType="supplementary"/>
                        <MiningField name="alertText_3_4" usageType="supplementary"/>
                        <MiningField name="alertText_4_1" usageType="supplementary"/>
                        <MiningField name="alertText_4_2" usageType="supplementary"/>
                        <MiningField name="alertText_4_3" usageType="supplementary"/>
                        <MiningField name="alertText_4_4" usageType="supplementary"/>
					
			<MiningField name="cnt_ALL" usageType="supplementary"/>
                        <MiningField name="cnt_withalart" usageType="supplementary"/>
			<!-- 3) sum of #tweets with analerts one on the left-->
                        <MiningField name="predictedField" usageType="predicted"/>
                </MiningSchema>
                <RuleSet defaultScore="0">
                        <RuleSelectionMethod criterion="firstHit"/>
                        <!-- 1) ScoreCheckRule calls scoreCheckTweets to be created -->
                        <SimpleRule id="ScoreCheckRule" score="1b">
                                <SimplePredicate field="scoreCheckTweets" operator="equal" value="true"/> <!-- 2) -->
                        </SimpleRule>
                </RuleSet>
        </RuleSetModel> </PMML> <!-- ===================================================================================================== --> <!-- 
===================================================================================================== -->
