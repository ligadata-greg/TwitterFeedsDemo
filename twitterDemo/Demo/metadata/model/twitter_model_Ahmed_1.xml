<PMML xmlns="http://www.dmg.org/PMML-4_1" version="4.1">

        <Header copyright="LigaDATA. Copyright 2014" description="Demo">
                <Application name="Demo" version="00.01.00"/>
        </Header>
		
        <DataDictionary numberOfFields="3">
                <DataField name="msg" displayName="msg" optype="categorical" dataType="twittermsg"/>
                <DataField name="gCtx" displayName="globalContext" optype="categorical" dataType="EnvContext"/>
                 <DataField name="parameters" displayName="parameters" dataType="container">
                        <Value value="gCtx" property="valid"/>
                        <Value value="msg" property="valid"/>
                </DataField>
                <DataField name="outputstr" displayName="outputstr" optype="categorical" dataType="string"/>
				
				<DataField name="predictedField" displayName="predictedField" optype="categorical" dataType="integer"/>
                                <DataField name="UDFSearchPath" displayName="UDFSearchPath" dataType="container">
                                        <Value value="com.ligadata.pmml.udfs.CustomUdfs" property="valid"/>
                                </DataField>
				<DataField name="tweet" displayName="tweet" optype="categorical" dataType="string"/>
				
                </DataDictionary>
        <TransformationDictionary>
		
		
		<!--        get array of security  -->
			<DerivedField name="securityContainer" dataType="ArrayOfMessageContainerBase" optype="categorical">
				<Apply function="GetArray">
					<FieldRef field="gCtx"/>
					<Constant dataType="string">System.security</Constant>
				</Apply>
			</DerivedField>

			<DerivedField name="security" dataType="ArrayOfSecurity" optype="categorical">
				<Apply function="DownCastArrayMembers">
					<FieldRef field="securityContainer"/>
					<Constant dataType="mbrTypename">security</Constant>
				</Apply>
			</DerivedField>
               
			<DerivedField name="securityTermsArray" dataType="ArrayOfString" optype="categorical">
				<Apply function="ToArray">
					<Apply function="ContainerMap">
						<FieldRef field="security"/>
						<Constant dataType="ident">terms</Constant> 
					</Apply>
				</Apply>
			</DerivedField>

				<!--check count of matche -->
			<DerivedField name="securityCounts" dataType="ArrayOfInt" optype="categorical">
				<Apply function="getTokenizedCounts">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="securityTermsArray"/>
				</Apply>
			</DerivedField>
			
			<!-- check if tweet has security-->
			<DerivedField name="CheckIfSecurityMatch" dataType="boolean" optype="categorical">
                <Apply function="getTokenizedBoolean">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="securityTermsArray"/>
					<Constant dataType="int">1</Constant>
				</Apply>
            </DerivedField>

		<!--        get array of applebrand  -->	
			
			<DerivedField name="appleBrandContainer" dataType="ArrayOfMessageContainerBase" optype="categorical">
				<Apply function="GetArray">
					<FieldRef field="gCtx"/>
					<Constant dataType="string">System.applebrand</Constant>
				</Apply>
			</DerivedField>

			<DerivedField name="appleBrand" dataType="ArrayOfAppleBrand" optype="categorical">
				<Apply function="DownCastArrayMembers">
					<FieldRef field="appleBrandContainer"/>
					<Constant dataType="mbrTypename">appleBrand</Constant>
				</Apply>
			</DerivedField>
               
			<DerivedField name="appleBrandTermsArray" dataType="ArrayOfString" optype="categorical">
				<Apply function="ToArray">
					<Apply function="ContainerMap">
						<FieldRef field="appleBrand"/>
						<Constant dataType="ident">terms</Constant> 
					</Apply>
				</Apply>
			</DerivedField>
							<!--check count of matche -->
							
			<DerivedField name="appleBrandCounts" dataType="ArrayOfInt" optype="categorical">
				<Apply function="getTokenizedCounts">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="appleBrandTermsArray"/>
				</Apply>
			</DerivedField>
							<!-- check if tweet has applebrand-->
			
			<DerivedField name="CheckIfAppleBrand" dataType="boolean" optype="categorical">
                <Apply function="getTokenizedBoolean">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="appleBrandTermsArray"/>
					<Constant dataType="int">1</Constant>
				</Apply>
            </DerivedField>
			
			<!--        get array of bankTwitter  -->
			
            <DerivedField name="bankTwitterContainer" dataType="ArrayOfMessageContainerBase" optype="categorical">
				<Apply function="GetArray">
					<FieldRef field="gCtx"/>
					<Constant dataType="string">System.banktwitter</Constant>
				</Apply>
			</DerivedField>

			<DerivedField name="bankTwitter" dataType="ArrayOfBankTwitter" optype="categorical">
				<Apply function="DownCastArrayMembers">
					<FieldRef field="bankTwitterContainer"/>
					<Constant dataType="mbrTypename">bankTwitter</Constant>
				</Apply>
			</DerivedField>
               
			<DerivedField name="bankTwitterTermsArray" dataType="ArrayOfString" optype="categorical">
				<Apply function="ToArray">
					<Apply function="ContainerMap">
						<FieldRef field="bankTwitter"/>
						<Constant dataType="ident">terms</Constant> 
					</Apply>
				</Apply>
			</DerivedField>
								<!--check count of matche -->
			<DerivedField name="bankTwitterCounts" dataType="ArrayOfInt" optype="categorical">
				<Apply function="getTokenizedCounts">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="bankTwitterTermsArray"/>
				</Apply>
			</DerivedField>
			
							<!-- check if tweet has bankTwitter -->
			<DerivedField name="CheckIfBankTwitter" dataType="boolean" optype="categorical">
                <Apply function="getTokenizedBoolean">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="bankTwitterTermsArray"/>
					<Constant dataType="int">1</Constant>
				</Apply>
            </DerivedField>
			
			<!--        get array of citiGroup  -->
			
            <DerivedField name="citiGroupContainer" dataType="ArrayOfMessageContainerBase" optype="categorical">
				<Apply function="GetArray">
					<FieldRef field="gCtx"/>
					<Constant dataType="string">System.citigroup</Constant>
				</Apply>
			</DerivedField>

			<DerivedField name="citiGroup" dataType="ArrayOfCitiGroup" optype="categorical">
				<Apply function="DownCastArrayMembers">
					<FieldRef field="citiGroupContainer"/>
					<Constant dataType="mbrTypename">citiGroup</Constant>
				</Apply>
			</DerivedField>
               
			<DerivedField name="citiGroupTermsArray" dataType="ArrayOfString" optype="categorical">
				<Apply function="ToArray">
					<Apply function="ContainerMap">
						<FieldRef field="citiGroup"/>
						<Constant dataType="ident">terms</Constant> 
					</Apply>
				</Apply>
			</DerivedField>
			
								<!--check count of matche -->
			<DerivedField name="citiGroupCounts" dataType="ArrayOfInt" optype="categorical">
				<Apply function="getTokenizedCounts">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="citiGroupTermsArray"/>
				</Apply>
			</DerivedField>
			
								<!-- check if tweet has citiGroup -->
			<DerivedField name="CheckIfCitiGroup" dataType="boolean" optype="categorical">
                <Apply function="getTokenizedBoolean">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="citiGroupTermsArray"/>
					<Constant dataType="int">1</Constant>
				</Apply>
            </DerivedField>
			
			
					<!--        get array of ligadata  -->
			
            <DerivedField name="ligadataContainer" dataType="ArrayOfMessageContainerBase" optype="categorical">
				<Apply function="GetArray">
					<FieldRef field="gCtx"/>
					<Constant dataType="string">System.ligadata</Constant>
				</Apply>
			</DerivedField>

			<DerivedField name="ligadata" dataType="ArrayOfligadata" optype="categorical">
				<Apply function="DownCastArrayMembers">
					<FieldRef field="ligadataContainer"/>
					<Constant dataType="mbrTypename">ligadata</Constant>
				</Apply>
			</DerivedField>
               
			<DerivedField name="ligadataTermsArray" dataType="ArrayOfString" optype="categorical">
				<Apply function="ToArray">
					<Apply function="ContainerMap">
						<FieldRef field="ligadata"/>
						<Constant dataType="ident">terms</Constant> 
					</Apply>
				</Apply>
			</DerivedField>
							<!--check count of matche -->
			<DerivedField name="ligadataCounts" dataType="ArrayOfInt" optype="categorical">
				<Apply function="getTokenizedCounts">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="ligadataTermsArray"/>
				</Apply>
			</DerivedField>
			
									<!-- check if tweet has ligadata-->
			<DerivedField name="CheckIfLigadata" dataType="boolean" optype="categorical">
                <Apply function="getTokenizedBoolean">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="ligadataTermsArray"/>
					<Constant dataType="int">1</Constant>
				</Apply>
            </DerivedField>
			
			
			<!--        get array of positiveTerms  -->
            <DerivedField name="positiveTermsContainer" dataType="ArrayOfMessageContainerBase" optype="categorical">
				<Apply function="GetArray">
					<FieldRef field="gCtx"/>
					<Constant dataType="string">System.positiveterms</Constant>
				</Apply>
			</DerivedField>

			<DerivedField name="positiveTerms" dataType="ArrayOfPositiveTerms" optype="categorical">
				<Apply function="DownCastArrayMembers">
					<FieldRef field="positiveTermsContainer"/>
					<Constant dataType="mbrTypename">positiveTerms</Constant>
				</Apply>
			</DerivedField>
               
			<DerivedField name="positiveTermsTermsArray" dataType="ArrayOfString" optype="categorical">
				<Apply function="ToArray">
					<Apply function="ContainerMap">
						<FieldRef field="positiveTerms"/>
						<Constant dataType="ident">terms</Constant> 
					</Apply>
				</Apply>
			</DerivedField>
							<!--check count of matche -->
			<DerivedField name="positiveTermsCounts" dataType="ArrayOfInt" optype="categorical">
				<Apply function="getTokenizedCounts">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="positiveTermsTermsArray"/>
				</Apply>
			</DerivedField>
			
							<!-- check if tweet has positiveTerms-->
			<DerivedField name="CheckIfPositiveTerms" dataType="boolean" optype="categorical">
                <Apply function="getTokenizedBoolean">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="positiveTermsTermsArray"/>
					<Constant dataType="int">1</Constant>
				</Apply>
            </DerivedField>
			
			<!--        get array of banking  -->
			
            <DerivedField name="bankingContainer" dataType="ArrayOfMessageContainerBase" optype="categorical">
				<Apply function="GetArray">
					<FieldRef field="gCtx"/>
					<Constant dataType="string">System.banking</Constant>
				</Apply>
			</DerivedField>

			<DerivedField name="banking" dataType="ArrayOfBanking" optype="categorical">
				<Apply function="DownCastArrayMembers">
					<FieldRef field="bankingContainer"/>
					<Constant dataType="mbrTypename">banking</Constant>
				</Apply>
			</DerivedField>
               
			<DerivedField name="bankingTermsArray" dataType="ArrayOfString" optype="categorical">
				<Apply function="ToArray">
					<Apply function="ContainerMap">
						<FieldRef field="banking"/>
						<Constant dataType="ident">terms</Constant> 
					</Apply>
				</Apply>
			</DerivedField>
								<!--check count of matche -->
			<DerivedField name="bankingCounts" dataType="ArrayOfInt" optype="categorical">
				<Apply function="getTokenizedCounts">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="bankingTermsArray"/>
				</Apply>
			</DerivedField>
			
								<!-- check if tweet has banking-->
			<DerivedField name="CheckIfBanking" dataType="boolean" optype="categorical">
                <Apply function="getTokenizedBoolean">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="bankingTermsArray"/>
					<Constant dataType="int">1</Constant>
				</Apply>
            </DerivedField>
			
								<!--     get array of barclays  -->
			
            <DerivedField name="barclaysContainer" dataType="ArrayOfMessageContainerBase" optype="categorical">
				<Apply function="GetArray">
					<FieldRef field="gCtx"/>
					<Constant dataType="string">System.barclays</Constant>
				</Apply>
			</DerivedField>

			<DerivedField name="barclays" dataType="ArrayOfBarclays" optype="categorical">
				<Apply function="DownCastArrayMembers">
					<FieldRef field="barclaysContainer"/>
					<Constant dataType="mbrTypename">barclays</Constant>
				</Apply>
			</DerivedField>
               
			<DerivedField name="barclaysTermsArray" dataType="ArrayOfString" optype="categorical">
				<Apply function="ToArray">
					<Apply function="ContainerMap">
						<FieldRef field="barclays"/>
						<Constant dataType="ident">terms</Constant> 
					</Apply>
				</Apply>
			</DerivedField>
									<!--check count of matche -->
			<DerivedField name="barclaysCounts" dataType="ArrayOfInt" optype="categorical">
				<Apply function="getTokenizedCounts">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="barclaysTermsArray"/>
				</Apply>
			</DerivedField>
			
									<!-- check if tweet has barclays-->
			<DerivedField name="CheckIfBarclays" dataType="boolean" optype="categorical">
                <Apply function="getTokenizedBoolean">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="barclaysTermsArray"/>
					<Constant dataType="int">1</Constant>
				</Apply>
            </DerivedField>
			
			<!--        get array of fruit_related  -->
			
            <DerivedField name="fruitRelatedContainer" dataType="ArrayOfMessageContainerBase" optype="categorical">
				<Apply function="GetArray">
					<FieldRef field="gCtx"/>
					<Constant dataType="string">System.fruitrelated</Constant>
				</Apply>
			</DerivedField>

			<DerivedField name="fruitRelated" dataType="ArrayOfFruitRelated" optype="categorical">
				<Apply function="DownCastArrayMembers">
					<FieldRef field="fruitRelatedContainer"/>
					<Constant dataType="mbrTypename">fruitRelated</Constant>
				</Apply>
			</DerivedField>
               
			<DerivedField name="fruitRelatedTermsArray" dataType="ArrayOfString" optype="categorical">
				<Apply function="ToArray">
					<Apply function="ContainerMap">
						<FieldRef field="fruitRelated"/>
						<Constant dataType="ident">terms</Constant> 
					</Apply>
				</Apply>
			</DerivedField>
			<!--check count of matche -->
			<DerivedField name="fruitRelatedCounts" dataType="ArrayOfInt" optype="categorical">
				<Apply function="getTokenizedCounts">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="fruitRelatedTermsArray"/>
				</Apply>
			</DerivedField>
			
			<!-- check if tweet has fruitRelated-->
			<DerivedField name="CheckIfFruitRelated" dataType="boolean" optype="categorical">
                <Apply function="getTokenizedBoolean">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="fruitRelatedTermsArray"/>
					<Constant dataType="int">1</Constant>
				</Apply>
            </DerivedField>
			
			
			<!--        get array of negative_terms  -->
			
            <DerivedField name="negativeTermsContainer" dataType="ArrayOfMessageContainerBase" optype="categorical">
				<Apply function="GetArray">
					<FieldRef field="gCtx"/>
					<Constant dataType="string">System.negativeterms</Constant>
				</Apply>
			</DerivedField>

			<DerivedField name="negativeTerms" dataType="ArrayOfNegativeTerms" optype="categorical">
				<Apply function="DownCastArrayMembers">
					<FieldRef field="negativeTermsContainer"/>
					<Constant dataType="mbrTypename">negativeTerms</Constant>
				</Apply>
			</DerivedField>
               
			<DerivedField name="negativeTermsTermsArray" dataType="ArrayOfString" optype="categorical">
				<Apply function="ToArray">
					<Apply function="ContainerMap">
						<FieldRef field="negativeTerms"/>
						<Constant dataType="ident">terms</Constant> 
					</Apply>
				</Apply>
			</DerivedField>
										<!--check count of matche -->
			<DerivedField name="negativeTermsTermsCounts" dataType="ArrayOfInt" optype="categorical">
				<Apply function="getTokenizedCounts">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="negativeTermsTermsArray"/>
				</Apply>
			</DerivedField>
			
									 <!-- check if tweet negativeTerms-->
			<DerivedField name="CheckIfNegativeTerms" dataType="boolean" optype="categorical">
                <Apply function="getTokenizedBoolean">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="negativeTermsTermsArray"/>
					<Constant dataType="int">1</Constant>
				</Apply>
            </DerivedField>
			
			<!--        get array of top20banks  -->
			
            <DerivedField name="top20banksContainer" dataType="ArrayOfMessageContainerBase" optype="categorical">
				<Apply function="GetArray">
					<FieldRef field="gCtx"/>
					<Constant dataType="string">System.top20banks</Constant>
				</Apply>
			</DerivedField>

			<DerivedField name="top20banks" dataType="ArrayOfTop20banks" optype="categorical">
				<Apply function="DownCastArrayMembers">
					<FieldRef field="top20banksContainer"/>
					<Constant dataType="mbrTypename">top20banks</Constant>
				</Apply>
			</DerivedField>
               
			<DerivedField name="top20banksTermsArray" dataType="ArrayOfString" optype="categorical">
				<Apply function="ToArray">
					<Apply function="ContainerMap">
						<FieldRef field="top20banks"/>
						<Constant dataType="ident">terms</Constant> 
					</Apply>
				</Apply>
			</DerivedField>
									<!--check count of matche -->
			<DerivedField name="top20banksCounts" dataType="ArrayOfInt" optype="categorical">
				<Apply function="getTokenizedCounts">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="top20banksTermsArray"/>
				</Apply>
			</DerivedField>
			
								<!-- check if tweet has top20banks -->
			<DerivedField name="CheckIfTop20banks" dataType="boolean" optype="categorical">
                <Apply function="getTokenizedBoolean">
					<FieldRef field="msg.tweet"/>
					<FieldRef field="top20banksTermsArray"/>
					<Constant dataType="int">1</Constant>
				</Apply>
            </DerivedField>
			

			<DerivedField name="ScoreCheck" dataType="boolean" optype="categorical">
				<Apply function="and">
					<Apply function="GreaterOrEqual">
						<FieldRef field="msg.id"/>
						<Constant dataType="string">1</Constant>
					</Apply>
					<Apply function="Put">
						<Constant dataType="string">tweet</Constant>
						<FieldRef field="msg.tweet"/>
					</Apply>
				</Apply>
			</DerivedField>
    </TransformationDictionary>

    <RuleSetModel modelName="DemoModel" functionName="classification" algorithmName="RuleSet">
        <MiningSchema>	
	    
		
     	<MiningField name="tweet" usageType="supplementary"/>
        <MiningField name="securityTermsArray" usageType="supplementary"/>
	    <MiningField name="appleBrandTermsArray" usageType="supplementary"/>
	    <MiningField name="bankTwitterTermsArray" usageType="supplementary"/>
	    <MiningField name="citiGroupTermsArray" usageType="supplementary"/>
	    <MiningField name="ligadataTermsArray" usageType="supplementary"/>
	    <MiningField name="positiveTermsTermsArray" usageType="supplementary"/>
	    <MiningField name="bankingTermsArray" usageType="supplementary"/>
	    <MiningField name="barclaysTermsArray" usageType="supplementary"/>
	    <MiningField name="fruitRelatedTermsArray" usageType="supplementary"/>
	    <MiningField name="negativeTermsTermsArray" usageType="supplementary"/>
	    <MiningField name="top20banksTermsArray" usageType="supplementary"/> 
		
		<MiningField name="tweet" usageType="supplementary"/>
        <MiningField name="CheckIfSecurityMatch" usageType="supplementary"/>
	    <MiningField name="CheckIfAppleBrand" usageType="supplementary"/>
	    <MiningField name="CheckIfBankTwitter" usageType="supplementary"/>
	    <MiningField name="CheckIfCitiGroup" usageType="supplementary"/>
	    <MiningField name="CheckIfLigadata" usageType="supplementary"/>
	    <MiningField name="CheckIfPositiveTerms" usageType="supplementary"/>
	    <MiningField name="CheckIfBanking" usageType="supplementary"/>
	    <MiningField name="CheckIfBarclays" usageType="supplementary"/>
	    <MiningField name="CheckIfFruitRelated" usageType="supplementary"/>
	    <MiningField name="CheckIfNegativeTerms" usageType="supplementary"/>
	    <MiningField name="CheckIfTop20banks" usageType="supplementary"/> 
	    <MiningField name="predictedField" usageType="predicted"/>
		
		
        </MiningSchema>

        <RuleSet defaultScore="0">
            <RuleSelectionMethod criterion="firstHit"/>
            <SimpleRule id="ScoreCheck" score="1b">
	      <SimplePredicate field="ScoreCheck" operator="equal" value="true"/>
	    </SimpleRule>
        </RuleSet>
    </RuleSetModel>
</PMML>
